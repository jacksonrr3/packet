#include <iostream>
#include <array>
#include <vector>
#include "packet.h"


int main() {
	
	std::array<unsigned char, 1000> arr_udp = { 0xe8, 0x5a, 0xa7, 0x20, 0x10, 0x02, 0x18, 0x31, 0xbf, 0x0c, 0x20, 0x95, 0x08, 0x00, 0x45, 0x00, 0x05, 0x62,
				0xc5, 0xb1, 0x40, 0x00, 0x80, 0x11, 0x00, 0x00, 0xc0, 0xa8, 0x0a, 0x02, 0x40, 0xe9, 0xa5, 0x5f, 0xd7, 0x16, 0x01, 0xbb, 0x05, 0x4e, 0xb6, 
		0x52, 0xc3, 0x51, 0x30, 0x34, 0x36, 0x50 };

	std::array<unsigned char, 1000> arr_tcp = { 0xe8, 0x5a, 0xa7, 0x20, 0x10, 0x02, 0x18, 0x31, 0xbf, 0x0c, 0x20, 0x95, 0x08, 0x00, 0x45, 0x00, 0x00, 0x34, 
		0x7b, 0xd4, 0x40, 0x00, 0x80, 0x06, 0x00, 0x00, 0xc0, 0xa8, 0x0a, 0x02, 0x0d, 0x21, 0xf2, 0xcc, 0xef, 0x84, 0x01, 0xbb, 0x03, 0x3a, 0xde, 0x04, 0x00,
		0x00, 0x00, 0x00, 0x80, 0x02, 0xfa, 0xf0, 0xca, 0xbe, 0x00, 0x00, 0x02, 0x04, 0x05, 0xb4, 0x01, 0x03, 0x03, 0x08, 0x01, 0x01, 0x04, 0x02};

	unsigned char* data_udp = arr_udp.data();
	Packet p_udp(data_udp, arr_tcp.size());
	auto l2_udp = p_udp.l2();
	std::cout << l2_udp->dstmac() << " " << l2_udp->srcmac() << std::endl;
	auto l3_udp = p_udp.l3();
	std::cout << l3_udp->scrip() << " " << l3_udp->dstip() << std::endl;
	auto l4_udp = p_udp.l4();

	unsigned char* data_tcp = arr_tcp.data();
	Packet p_tcp(data_tcp, arr_tcp.size());
	auto l2_tcp = p_tcp.l2();
	std::cout << l2_tcp->dstmac() << " " << l2_tcp->srcmac() << std::endl;
	auto l3_tcp = p_tcp.l3();
	std::cout << l3_tcp->scrip() << " " << l3_tcp->dstip() << std::endl;
	auto l4_tcp = p_tcp.l4();
	

	return 0;
}
