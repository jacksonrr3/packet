#include <iostream>
#include "analyzer.h"


int main() {
//тестовый пример. в массиве только заголовки и первые 8 байт из поля data протокола UDP
	std::array<unsigned char, 1000> arr = { 0xe8, 0x5a, 0xa7, 0x20, 0x10, 0x02, 0x18, 0x31, 0xbf, 0x0c, 0x20, 0x95, 0x08, 0x00, 0x45, 0x00, 0x05, 0x62,
				0xc5, 0xb1, 0x40, 0x00, 0x80, 0x11, 0x00, 0x00, 0xc0, 0xa8, 0x0a, 0x02, 0x40, 0xe9, 0xa5, 0x5f, 0xd7, 0x16, 0x01, 0xbb, 0x05, 0x4e, 0xb6, 0x52, 0xc3, 0x51, 0x30, 0x34, 0x36, 0x50 };

	unsigned char* data = arr.data();
	Packet p(data, arr.size());
	auto l2 = p.l2();
	std::cout << l2->dstmac() << " " << l2->srcmac() << std::endl;
	auto l3 = p.l3();
	std::cout << l3->scrip() << " " << l3->dstip() << std::endl;
	auto l4 = p.l4();

	return 0;
}
